---
title: "02 - Circular statistics"
author: "Francisco E. Fonturbel and Javier Cuadra"
date: "26/jun/2019"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Animal activity analysis

## 02 - Circular statistics

**Circular statistics** are an analytic approach to deal with time data. Here we will use the `circular` package to deal with animal activity data, and the `plotrix` package to produce some plots.

```{r data_packages, echo=TRUE}
#Loading the libraries needed to work with circular data and do plots
library("circular")
library("plotrix")

#Loading an example dataset
actividad<-read.table("./data/activity.txt", header= T)
```


### Data (time) transformation to radians

A given time, say 15:26 h in a 24h clock can be also expressed as a radian in a circle. Therefore, before start analyzing activity data we should transform time data to radians using the following formula:

$$
rad=time*2*{\pi}
$$
**Important:** Prior to transform time data to radians you must convert your time figures to a number.

```{r radian, echo=TRUE}
radian <- actividad$Time_2*2*pi
data <- radian[actividad$Condition == "A"]
```

Then, we have to convert our radian data into a `circular class` object in order to be used with the `circular` package.

```{r circ_class, echo=TRUE, warning=FALSE}

as.circular(data)
n_a <- circular(data%%24, 
                     units="radians", template="clock24")

```

## Rose diagrams

A simple representation of activity data is the rose diagram, which is obtained using the function `rose.diag` to represent a circular dataset into a 24h clock.

```{r rose_diag, echo=TRUE, eval=TRUE, fig.width=8}
rose.diag(n_a, bin = 24, col = "lightblue", main = "Rose diagram", 
          prop = 2)
```

## Frequency plots

A more elaborated representation of activity periods than the rose diagram is the frequency plot. On a frequency plot, the lenght of each bar is proportional to .

To make a decent frequency plot we njeed to arrange our data in a table with frequency of records per hour. We'll load a new file (ready to go) as example.

Then, we will use the `clock24.plot` function of the `plotrix` package.

```{r freq_plot, echo=TRUE, eval=TRUE, fig.width=8}
#Loading new data file
actividad_table<-read.table("./data/records_hour.txt", header= T)

#Making the plot
clock<-c(0:23) 
clock24.plot(actividad_table$A,clock, minutes=T, label.prop=c(1.15,1.15),show.grid.labels = 3,  show.grid=T, grid.bg="white", grid.left=T,grid.col="black",rad.col="black", rp.type="r",lwd=10,line.col="blue",lty=1, main="",add=F)


```


## Session

```{r session, echo=TRUE}
sessionInfo()
```