---
title: "Animal activity analysis"
author: "Francisco E. Fonturbel and Javier Cuadra"
date: "26/jun/2019"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 03 - Kernel Density Plots

## Kenrnel density plots are effective way to view distribution of variable (time). Can be considered as plots of smoothed histograms

# Package 'activity'


```{r data_packages, echo=TRUE}
#Loading required packages
library("overlap")
library ("activity")
#Loading two activity datasets (time)
act_x<-read.table("./Data/act_x.txt", header= T)
act_y<-read.table("./Data/act_y.txt", header= T)
```

## transform data (time) to radian

```{r rad, echo=TRUE, eval=TRUE}

rad_x<-act_x$Time_2*2*pi
rad_y<-act_y$Time_2*2*pi

```

## fitted data y extraction for condition 


```{r fit, echo=TRUE, eval=TRUE, warning=FALSE, error=FALSE}
fitact_a <-fitact(rad_x[act_x$Condition=="A"])
fitact_b <-fitact(rad_y[act_y$Condition=="A"])
```

## Density Plot

```{r denplot, echo=TRUE, eval=TRUE, fig.width=8}
#Density plot for dataset A
plot(fitact_a, yunit="dens", las=1, dline=list(col="lightblue"), tline=list(col="blue"), main="Data X", ylim=c(0,0.17))

#Density plot for dataset B
plot(fitact_b, yunit="dens", las=1, dline=list(col="pink"), tline=list(col="red"), main = "Data Y")
   
```


## plot two graphs in same plot. Compare same condition (A)

```{r denpcomp, echo=TRUE, eval=TRUE, fig.width=8}
plot(fitact_a, yunit="dens", las=1, dline=list(col="lightblue"), tline=list(col="blue"), ylim=c(0,0.17))
     plot(fitact_b, yunit="dens", add=TRUE, dline=list(col="pink"), tline=list(col="red"))
     legend("topright", inset = c(0,0), title = "Data", c("X", "Y"), lty= c(1,1), col = c("lightblue", "pink"), bty = "n")

```


# Coefficient of overlap (Dhat5)

## Coefficient of is the area under a density curve.This index is purely descriptive.

## The function 'CompareCkern' in the package 'activity', is a test probability that two sets of data come from the same distribution. In addition, this test calculate overlap index Dhat5 for two fitted distributions (with function 'fitact')

## Compare data X and Y, for same condition  "A"
```{r comp, echo=TRUE}
compareCkern(fitact_a, fitact_b, reps = 100)
```

# Package Overlap

## extraction of data for condition 

```{r}

act_a <- rad_x[act_x$Condition=="A"]

act_b <- rad_y[act_y$Condition=="A"]

```

## Density Plot

```{r}

densityPlot(act_a, xscale = 24, xcenter = c("noon", "midnight"), add = F, rug = T, extend = "lightgray", main = "Data X", xlab = "Time", ylab = "Density", bty = "L")


```

```{r}
densityPlot(act_b, xscale = 24, xcenter = c("noon", "midnight"), add = F, rug = T, extend = "lightgray", main = "Data Y", xlab = "Time", ylab = "Density", bty = "L")
```

## plot two graphs in same plot with 'Overlap', for same condition (A)

```{r}
overlapPlot(act_a, act_b, main = " ", linecol = c("black", "darkgreen"), lty = c(1,3), bty = "L", xlab = "Time", ylab = "Density")
legend("topright", inset = c(0,0), title = "Data", c("X", "Y"), lty= c(1,3), col = c("gray25", "seagreen"), bty = "n")

```

## Session

```{r session, echo=TRUE}
sessionInfo()
```